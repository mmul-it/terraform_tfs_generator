---

# Which environment we're going to deploy
terraform_cloud_provider: 'libvirt'
terraform_libvirt_provider_version: '0.7.1'

# Libvirt connection uri
terraform_libvirt_uri: 'qemu:///system'

# Which groups of machines will be processed by the role
terraform_libvirt_vms_groups:
  - 'mylabvmsgroup'

# Libvirt vNets configuration
terraform_libvirt_networks:
  - name: 'mylabnetwork'
    mode: 'nat'
    addresses:
      - '192.168.199.0/24'

# Libvirt pools
terraform_libvirt_pools:
  - name: 'mylabpool'
    type: 'dir'
    path: '/lab'

# Libvirt volumes
terraform_libvirt_volumes:
  - volume_id: 'almalinux-8'
    file: 'almalinux-8.qcow2'
    pool: 'mylabpool'
    source: 'https://repo.almalinux.org/almalinux/8/cloud/x86_64/images/AlmaLinux-8-GenericCloud-latest.x86_64.qcow2'
    format: 'qcow2'

# Libvirt cloud inits
terraform_libvirt_cloud_inits:
  - name: 'mylabcloudinit'
    pool: 'mylabpool'
    cfg:
      ssh_pwauth: true
      users:
        - name: myuser
          passwd: "{{ 'password' | password_hash('sha512') }}"
          lock_passwd: false
          sudo: ALL=(ALL) NOPASSWD:ALL
