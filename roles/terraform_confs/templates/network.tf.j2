# Virtual network creation block
resource "azurerm_virtual_network" "{{ azure_vnet_name }}" {
  name                = "{{ azure_vnet_name }}"
  address_space       = ["{{ azure_vnet_addr_space }}"]
  location            = var.location
  resource_group_name = var.resource_group_name
  depends_on          = [azurerm_resource_group.{{ azure_resource_group_name }}]
}

# Subnet creation block
resource "azurerm_subnet" "{{ azure_subnet_name }}" {
  name                 = "{{ azure_subnet_name }}"
  resource_group_name  = var.resource_group_name
  virtual_network_name = azurerm_virtual_network.{{ azure_vnet_name }}.name
  address_prefix       = "{{ azure_subnet_addr_prefix }}"
  depends_on           = [azurerm_virtual_network.{{ azure_vnet_name }}]
}

# Gateway subnet creation block (required for vpn P2S) please notice that
resource "azurerm_subnet" "{{ azure_gw_subnet_name }}" {
  name                 = "GatewaySubnet"
  resource_group_name  = var.resource_group_name
  virtual_network_name = azurerm_virtual_network.{{ azure_vnet_name }}.name
  address_prefix       = "{{ azure_gw_subnet_addr_prefix }}"
  depends_on           = [azurerm_virtual_network.{{ azure_vnet_name }}]
}
